@{
    ViewData["Title"] = "Порівняння Назва товару";

    // Отримуємо дані з ViewBag/ViewData, передані з контролера
    var products = ViewBag.Products as List<Dictionary<string, object>>;
    var displaySpecs = ViewBag.DisplaySpecs as List<Dictionary<string, object>>;
    var processorSpecs = ViewBag.ProcessorSpecs as List<Dictionary<string, object>>;
    var ramSpecs = ViewBag.RamSpecs as List<Dictionary<string, object>>;
}

<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewData["Title"]</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="/css/product-comparation-page.css" rel="stylesheet">
</head>

<body>
    <div class="container-xxl">
        <h1 class="text-center my-3 border-bottom pb-3">@ViewData["Title"]</h1>

        <!-- Єдина таблиця для всього контенту -->
        <div class="table-container">


            <table class="comparison-table" style="table-layout: fixed; width: 100%;">
                <colgroup>
                    <col class="feature-column">
                    <col class="product-column" span="@products.Count">
                </colgroup>

                            <!-- Перший рядок: Товари -->
                <tr class="products-row">
                    <!-- Додати товар до порівняння -->
                    <td class="add-to-compare">
                        <div class="add-compare-container">
                            <div class="add-compare-text">Додати товар до порівняння</div>
                            <div class="add-button-container">
                                <button class="add-compare-button">+</button>
                            </div>
                        </div>
                    </td>

                    @for (int i = 0; i < products.Count; i++)
                    {
                        var product = products[i];
                        <td class="product-item text-center">
                            <div>
                            <div class="image-container">
                                <img src="@product["ImageUrl"]" alt="@product["ModelName"]" class="product-image" />
                            </div>
                            <div class="mt-2 model-name">@product["ModelName"]</div>
                            <div class="price">від @product["MinPrice"] до @product["MaxPrice"] грн</div>
                            <div class="small text-muted">порівняти ціну @product["PriceCount"]</div>
                            <img src="@product["BrandLogoUrl"]" alt="@product["Brand"]" class="brand-logo" />
                            </div>
                        </td>
                    }
                </tr>





                <!-- Другий рядок: Кнопки фільтрів -->
                <tr class="filter-buttons-row">
                    <td colspan="@(products.Count + 1)">
                        <div class="d-flex justify-content-between align-items-center p-2">
                            <div class="btn-group" role="group">
                                <button type="button" class="btn btn-outline-secondary tab-custom active">
                                    Всі
                                    характеристики
                                </button>
                                <button type="button" class="btn btn-outline-secondary tab-custom">Відмінні</button>
                            </div>
                            <div>
                                <button class="btn btn-primary filter-button">Фільтри за параметрами ▼</button>
                            </div>
                        </div>
                    </td>
                </tr>

                <!-- Секція "Дисплей" -->
                <tr class="section-header">
                    <td colspan="@(products.Count + 1)">Дисплей</td>
                </tr>
                @foreach (var spec in displaySpecs)
                {
                    <tr>
                        <td class="feature-name">@spec["Name"]</td>
                        @foreach (var product in products)
                        {
                            <td class="text-center">@product[spec["Key"].ToString()]</td>
                        }
                    </tr>
                }

                <!-- Секція "Процесор" -->
                <tr class="section-header">
                    <td colspan="@(products.Count + 1)">Процесор</td>
                </tr>
                @foreach (var spec in processorSpecs)
                {
                    <tr>
                        <td class="feature-name">@spec["Name"]</td>
                        @foreach (var product in products)
                        {
                            <td class="text-center">@product[spec["Key"].ToString()]</td>
                        }
                    </tr>
                }

                <!-- Секція "Оперативна пам'ять" -->
                <tr class="section-header">
                    <td colspan="@(products.Count + 1)">Оперативна пам'ять</td>
                </tr>
                @foreach (var spec in ramSpecs)
                {
                    <tr>
                        <td class="feature-name">@spec["Name"]</td>
                        @foreach (var product in products)
                        {
                            <td class="text-center">@product[spec["Key"].ToString()]</td>
                        }
                    </tr>
                }
            </table>


        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const container = document.querySelector('.table-container');
            const products = document.querySelectorAll('.product-item').length;

            // Додаємо клас, який вказує на кількість товарів
            container.classList.add(`products-${products}`);

            // Встановлюємо CSS змінну
            document.documentElement.style.setProperty('--product-count', products);
        });
    </script>
</body>

</html>